<!--
  Copyright 2016 Pimoroni Ltd

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/javascript">
    RED.nodes.registerType("rpi-explorerhat in",{
        category: "Raspberry Pi",
        paletteLabel: "Explorer HAT",
        color: '#c6dbef',
        defaults: {
            name: { value: "" },
            touch: { value: true },
            input: { value: true },
            analog: { value: true }
        },
        inputs:0,
        outputs:1,
        icon:  "rpi.png",
        label: function() {
            return this.name||"Explorer HAT";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
    RED.nodes.registerType("rpi-explorerhat out",{
        category: "Raspberry Pi",
        paletteLabel: "Explorer HAT",
        color: '#c6dbef',
        defaults: {
            name: { value: "" },
        },
        inputs:1,
        outputs:0,
        icon:  "rpi.png",
        label: function() {
            return this.name||"Explorer HAT";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });

</script>

<script type="text/x-red" data-template-name="rpi-explorerhat in">
<div class="form-row">
    <label><i class="fa fa-arrow-right"></i> Outputs</label>
    <label style="width: auto" for="node-input-touch"><input style="vertical-align: top; width: auto; margin-right: 5px;" type="checkbox" id="node-input-touch"> Touch events</label>
    <div style="padding-left: 125px; margin-top: -5px; color: #bbb;">Touch pads 1, 2, 3, 4, 5, 6, 7 and 8</div>
</div>
<div class="form-row">
    <label></label>
    <label style="width: auto" for="node-input-input"><input style="vertical-align: top; width: auto; margin-right: 5px;" type="checkbox" id="node-input-input"> Input events</label>
    <div style="padding-left: 125px; margin-top: -5px; color: #bbb;">5v tolerant inputs 1, 2, 3 and 4</div>
</div>
<div class="form-row">
    <label></label>
    <label style="width: auto" for="node-input-analog"><input style="vertical-align: top; width: auto; margin-right: 5px;" type="checkbox" id="node-input-analog"> Analog events</label>
    <div style="padding-left: 125px; margin-top: -5px; color: #bbb;">5v tolerant analog inputs 1, 2, 3 and 4</div>
</div>

<div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name">
</div>
</script>

<script type="text/x-red" data-help-name="rpi-explorerhat in">
<p>Raspberry Pi Explorer HAT input node.</p>
<p>This node sends readings from the various inputs on Explorer HAT, grouped into three sets; touch events, input events and analog events.</p>

<p><b>Touch Events</b></p>
<p>Touch events are generated by the 8 touch-sensitive pads on Explorer HAT. A message will be sent every time a touch pad is touched, or released. The <code>topic</code> is set to <code>explorerhat/touch.&lt;channel&gt;</code> and the <code>payload</code> is a number that's either:</p>
<ul>
    <li><code>1</code> : the touch pad indicated in the topic has been touched.</li>
    <li><code>0</code> : the touch pad indicated in the topic has been released.</li>
</ul>
<p>For example, a topic of <code>explorerhat/touch.1</code> and a payload of <code>1</code> would indicate that touch pad one was been touched.</p>

<p><b>Input Events</b></p>
<p>Input events are generated by the four 5v tolerant protected inputs on Explorer HAT. A message will be sent every time an input changes. The <code>topic</code> is set to <code>explorerhat/input.&lt;channel&gt;</code> and the <code>payload</code> is an number that's either:</p>
<ul>
    <li><code>1</code> : indicating the input is HIGH.</li>
    <li><code>0</code> : indicating the input is LOW.</li>
</ul>

<p><b>Analog Events</b></p>
<p>Analog events are generated by the four 5v tolerant analog inputs on Explorer HAT. A message will be sent when the analog value changes by 10mV or more, giving 500 steps of granularity. The <code>topic</code> is set to <code>explorerhat/analog.&lt;channel&gt;</code> and the <code>payload</code> is a number ranging from 0 (0v) to 5 (5v):</p>

<p>For example, a topic of <code>explorerhat/analog.2</code> and a payload of <code>3.33</code> would indicate that 3.33v is present on Analog 2.</p>

</script>

<script type="text/x-red" data-template-name="rpi-explorerhat out">
<div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name">
</div>
</script>

<script type="text/x-red" data-help-name="rpi-explorerhat out">
<p>Raspberry Pi Explorer HAT output node.</p>
<p>This node controls the various outputs on Explorer HAT, grouped into three sets; digital outputs, lights and motors.</p>

<p><b>Digital Outputs</b></p>
<p>Digital outputs are controlled by sending a message with the topic <code>output.&lt;channel&gt;</code> where channel is a number from 1 to 4 (corresponding to the numbers on the Explorer HAT board) or a name from "one" to "four" if you prefer.</p>
<p>The <code>payload</code> of the message should be set to either:</p>
<ul>
    <li><code>1</code> or <code>on</code> : to turn the output on.</li>
    <li><code>0</code> or <code>off</code> : to turn the output off.</li>
</ul>

<p><b>Lights</b></p>
<p>Lights are controlled by sending a message with the topic <code>light.&lt;channel&gt;</code> where channel is a number from 1 to 4 (corresponding to the numbers on the Explorer HAT board) or a colour name "blue", "yellow", "green" or "red" if you prefer.</p>
<p>The <code>payload</code> of the message should be set to either:</p>
<ul>
    <li><code>1</code> or <code>on</code> : to turn the light on.</li>
    <li><code>0</code> or <code>off</code> : to turn the light off.</li>
</ul>

<p><b>Motors</b></p>
<p>Motors are controlled by sending a message with the topic <code>motor.&lt;channel&gt;</code> where channel is a number from 1 to 2 (corresponding to the numbers on the Explorer HAT board) or the name "one" or "two".</p>
<p>The <code>payload</code> should be set to a value between <code>-100</code> and </code>100</code>, with <code>0</code> being full stop</p>

</script>

